# Karl's GIR - Development Setup

**Version:** 3.1.0
**Last Updated:** November 2025

## ğŸš€ Quick Start

### **1. Development (Hot Reload)**
```bash
npm run dev
```
- Opens at: **http://localhost:3000**
- Hot reload enabled (instant updates)
- API calls proxied to Laragon PHP backend
- Best for: Building features, testing, debugging

### **2. Production Build**
```bash
npm run build
```
- Outputs to: `/public/` folder
- Minified, optimized bundle
- Includes: Frontend app, API, admin dashboard, static assets
- Test at: **http://karlgolf.app.test/** (Laragon local)
- Best for: Testing before deployment

**Build Process:**
1. `pre-build.js` - Updates service worker version
2. `tsc` - TypeScript compilation (type checking)
3. `vite build` - Bundles React app to `/public/`
4. `build-deploy.js` - Copies `/api/`, `/admin/`, static assets to `/public/`

### **2b. Auto-Build on Changes (Watch Mode)**
```bash
npm run build:watch
```
- Automatically rebuilds when files in `src/`, `api/`, or `admin/` change
- Watches: `.ts`, `.tsx`, `.css`, `.json`, `.php` files
- Perfect for: Making edits that require a new build
- **Tip:** Keep this running in a separate terminal while editing

### **3. Preview Production Build**
```bash
npm run preview
```
- Opens at: **http://localhost:4173**
- Serves production build locally
- Best for: Final testing before deployment

---

## ğŸ“ Directory Structure

```
/
â”œâ”€â”€ src/                    # TypeScript source code
â”‚   â”œâ”€â”€ components/         # React components (IconNav, Modal, etc.)
â”‚   â”œâ”€â”€ pages/              # Page components (HomePage, DashboardPage, etc.)
â”‚   â”œâ”€â”€ hooks/              # Custom React hooks (useAuth, usePageTracking)
â”‚   â”œâ”€â”€ lib/                # Utilities (API, stats, storage, analytics)
â”‚   â””â”€â”€ types/              # TypeScript type definitions
â”‚
â”œâ”€â”€ api/                    # PHP backend (source - copied to /public during build)
â”‚   â”œâ”€â”€ auth/               # Authentication endpoints
â”‚   â”œâ”€â”€ rounds/             # Round management
â”‚   â”œâ”€â”€ stats/              # Statistics
â”‚   â”œâ”€â”€ admin/              # Admin endpoints
â”‚   â””â”€â”€ common/             # Shared utilities
â”‚
â”œâ”€â”€ admin/                  # Admin dashboard (source - copied to /public during build)
â”‚   â”œâ”€â”€ index.html          # Admin UI (React from CDN)
â”‚   â””â”€â”€ admin-styles.css    # Admin styles
â”‚
â”œâ”€â”€ public/                 # Build output (generated by npm run build)
â”‚   â”œâ”€â”€ index.html          # Main app entry
â”‚   â”œâ”€â”€ assets/             # Bundled JS/CSS (hashed filenames)
â”‚   â”œâ”€â”€ api/                # PHP backend (copied from /api)
â”‚   â”œâ”€â”€ admin/              # Admin dashboard (copied from /admin)
â”‚   â”œâ”€â”€ images/             # Static images
â”‚   â”œâ”€â”€ icons/              # PWA icons
â”‚   â”œâ”€â”€ styles.css          # Global CSS
â”‚   â”œâ”€â”€ manifest.json       # PWA manifest
â”‚   â”œâ”€â”€ service-worker.js   # Service worker
â”‚   â””â”€â”€ .htaccess           # Apache configuration
â”‚
â”œâ”€â”€ data/                   # User data JSON files (local dev only)
â”‚   â””â”€â”€ {user_hash}/        # Per-user directories
â”‚
â”œâ”€â”€ docs/                   # Documentation
â”œâ”€â”€ pre-build.js            # Pre-build script
â”œâ”€â”€ build-deploy.js         # Post-build script
â”œâ”€â”€ package.json            # NPM dependencies
â”œâ”€â”€ tsconfig.json           # TypeScript config
â””â”€â”€ vite.config.ts          # Vite config
```

---

## ğŸ”§ How API Proxy Works

### **Development (Vite Dev Server):**
- Frontend runs on: `http://localhost:3000`
- API requests to `/api/*` are proxied to: `http://localhost/karlgolf.app/api/`
- This allows testing with local PHP backend (Laragon)

### **Production:**
- Frontend and API both on: `https://karlgolf.app`
- No proxy needed - direct API calls

---

## ğŸ› ï¸ Development Workflow

### Making Changes

1. **Edit source files** in `/src/`
2. **Development mode:** Changes auto-reload (`npm run dev`)
3. **Production build:** Run `npm run build` to test production build
4. **Test locally:** Use `npm run preview` or Laragon local server
5. **Deploy:** Upload `/dist/` contents to production root

### File Organization

- **Components:** Reusable UI components in `/src/components/`
- **Pages:** Full page components in `/src/pages/`
- **Hooks:** Custom React hooks in `/src/hooks/`
- **Lib:** Utility functions (API, stats, validation) in `/src/lib/`
- **Types:** TypeScript type definitions in `/src/types/`

### UI Standards

- **Page Layout:** See [PAGE-LAYOUT-STANDARD.md](PAGE-LAYOUT-STANDARD.md)
- **Button Styling:** See [BUTTON-STANDARDS.md](BUTTON-STANDARDS.md)
- **Modal Component:** See [MODAL-COMPONENT-GUIDE.md](MODAL-COMPONENT-GUIDE.md)

---

## ğŸ“¦ Dependencies

### Production Dependencies
- `react` & `react-dom` - UI framework
- `react-router-dom` - Client-side routing
- `@tanstack/react-query` - Data fetching and caching
- `react-hot-toast` - Toast notifications
- `@fortawesome/react-fontawesome` - Icons

### Development Dependencies
- `vite` - Build tool
- `@vitejs/plugin-react` - React plugin for Vite
- `typescript` - Type checking
- `nodemon` - Watch mode for builds

---

## ğŸ” Debugging

### Browser Console
- Check for JavaScript errors
- Network tab for API calls
- Application tab for service worker status

### TypeScript Errors
- Run `npm run build` to see TypeScript compilation errors
- IDE should show errors in real-time

### API Debugging
- Check Laragon PHP error logs
- Check browser Network tab for API responses
- Verify API endpoints in `/api/` directory

---

## ğŸš€ Deployment

### Build for Production
```bash
npm run build
```

### Upload to Production
1. Upload all files from `/dist/` to production root `/`
2. Upload `/api/` folder to production `/api/`
3. Upload `data/.htaccess` to production `/data/.htaccess`
4. Create `/data/` directory on server (755 permissions)

See **[FTP Upload Guide](FTP-UPLOAD-GUIDE.md)** for complete instructions.

---

## ğŸ“ Notes

- **Local Directory:** Project moved from `karlgolf.app_pwa` to `karlgolf.app`
- **Base Path:** Changed from `/dist/` to `/` for clean URLs
- **Build Output:** All files go to `/dist/` but are deployed to root
- **Service Worker:** Automatically registered on app load
- **PWA:** Fully functional with install prompt and offline support

---

**Last Updated:** v3.0.0 Production Release
